{"ast":null,"code":"import React,{useEffect,useState}from'react';import{motion}from'framer-motion';import{CheckCircle,AlertCircle,Loader}from'lucide-react';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const GoogleCalendarCallback=()=>{const[status,setStatus]=useState('processing');// 'processing', 'success', 'error'\nconst[message,setMessage]=useState('Processing Google Calendar authorization...');useEffect(()=>{const handleCallback=async()=>{const urlParams=new URLSearchParams(window.location.search);const code=urlParams.get('code');const state=urlParams.get('state');const error=urlParams.get('error');if(error){console.error('OAuth error:',error);setStatus('error');setMessage('Authorization was denied or failed. Please try again.');// Close popup or redirect on error\nif(window.opener){window.close();}else{setTimeout(()=>{window.location.href='/';},3000);}return;}if(code){try{// Exchange code for tokens\nconst response=await fetch('/api/v1/calendar/exchange-token',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({authorization_code:code,state:state})});const data=await response.json();if(data.success){// Store credentials in localStorage for the parent window to pick up\nlocalStorage.setItem('google_calendar_credentials',JSON.stringify(data.credentials));setStatus('success');setMessage('Google Calendar authorization successful!');// Close the popup window if this is running in a popup\nif(window.opener){window.close();}else{// Redirect to main app if not in popup\nsetTimeout(()=>{window.location.href='/';},2000);}}else{console.error('Failed to exchange token:',data);setStatus('error');setMessage('Failed to authorize Google Calendar. Please try again.');}}catch(err){console.error('Error exchanging token:',err);setStatus('error');setMessage('An error occurred during authorization. Please try again.');}}};handleCallback();},[]);const getStatusIcon=()=>{switch(status){case'success':return/*#__PURE__*/_jsx(CheckCircle,{className:\"h-16 w-16 text-green-500\"});case'error':return/*#__PURE__*/_jsx(AlertCircle,{className:\"h-16 w-16 text-red-500\"});default:return/*#__PURE__*/_jsx(Loader,{className:\"h-16 w-16 text-blue-500 animate-spin\"});}};const getStatusColor=()=>{switch(status){case'success':return'text-green-600';case'error':return'text-red-600';default:return'text-blue-600';}};return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center min-h-screen bg-gray-50\",children:/*#__PURE__*/_jsxs(motion.div,{className:\"text-center p-8 bg-white rounded-lg shadow-lg max-w-md mx-4\",initial:{opacity:0,scale:0.9},animate:{opacity:1,scale:1},transition:{duration:0.3},children:[/*#__PURE__*/_jsx(motion.div,{className:\"mb-6\",initial:{scale:0},animate:{scale:1},transition:{delay:0.2,type:\"spring\",stiffness:200},children:getStatusIcon()}),/*#__PURE__*/_jsxs(motion.h2,{className:`text-xl font-semibold mb-4 ${getStatusColor()}`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:0.3},children:[status==='processing'&&'Processing Authorization',status==='success'&&'Authorization Successful',status==='error'&&'Authorization Failed']}),/*#__PURE__*/_jsx(motion.p,{className:\"text-gray-600 leading-relaxed\",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:0.4},children:message}),status==='success'&&/*#__PURE__*/_jsx(motion.p,{className:\"text-sm text-gray-500 mt-4\",initial:{opacity:0},animate:{opacity:1},transition:{delay:0.6},children:\"This window will close automatically...\"}),status==='error'&&/*#__PURE__*/_jsx(motion.p,{className:\"text-sm text-gray-500 mt-4\",initial:{opacity:0},animate:{opacity:1},transition:{delay:0.6},children:\"Redirecting back to the app...\"})]})});};export default GoogleCalendarCallback;","map":{"version":3,"names":["React","useEffect","useState","motion","CheckCircle","AlertCircle","Loader","axios","jsx","_jsx","jsxs","_jsxs","GoogleCalendarCallback","status","setStatus","message","setMessage","handleCallback","urlParams","URLSearchParams","window","location","search","code","get","state","error","console","opener","close","setTimeout","href","response","fetch","method","headers","body","JSON","stringify","authorization_code","data","json","success","localStorage","setItem","credentials","err","getStatusIcon","className","getStatusColor","children","div","initial","opacity","scale","animate","transition","duration","delay","type","stiffness","h2","y","p"],"sources":["/Users/darshiyer/Desktop/DeadPool/Downloads/Tsunade/Tsunade/frontend/src/components/GoogleCalendarCallback.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { motion } from 'framer-motion';\nimport { CheckCircle, AlertCircle, Loader } from 'lucide-react';\nimport axios from 'axios';\n\nconst GoogleCalendarCallback = () => {\n  const [status, setStatus] = useState('processing'); // 'processing', 'success', 'error'\n  const [message, setMessage] = useState('Processing Google Calendar authorization...');\n\n  useEffect(() => {\n    const handleCallback = async () => {\n      const urlParams = new URLSearchParams(window.location.search);\n      const code = urlParams.get('code');\n      const state = urlParams.get('state');\n      const error = urlParams.get('error');\n\n      if (error) {\n        console.error('OAuth error:', error);\n        setStatus('error');\n        setMessage('Authorization was denied or failed. Please try again.');\n        \n        // Close popup or redirect on error\n        if (window.opener) {\n          window.close();\n        } else {\n          setTimeout(() => {\n            window.location.href = '/';\n          }, 3000);\n        }\n        return;\n      }\n\n      if (code) {\n        try {\n          // Exchange code for tokens\n          const response = await fetch('/api/v1/calendar/exchange-token', {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({\n              authorization_code: code,\n              state: state\n            }),\n          });\n\n          const data = await response.json();\n          \n          if (data.success) {\n            // Store credentials in localStorage for the parent window to pick up\n            localStorage.setItem('google_calendar_credentials', JSON.stringify(data.credentials));\n            \n            setStatus('success');\n            setMessage('Google Calendar authorization successful!');\n            \n            // Close the popup window if this is running in a popup\n            if (window.opener) {\n              window.close();\n            } else {\n              // Redirect to main app if not in popup\n              setTimeout(() => {\n                window.location.href = '/';\n              }, 2000);\n            }\n          } else {\n            console.error('Failed to exchange token:', data);\n            setStatus('error');\n            setMessage('Failed to authorize Google Calendar. Please try again.');\n          }\n        } catch (err) {\n          console.error('Error exchanging token:', err);\n          setStatus('error');\n          setMessage('An error occurred during authorization. Please try again.');\n        }\n      }\n    };\n\n    handleCallback();\n  }, []);\n\n  const getStatusIcon = () => {\n    switch (status) {\n      case 'success':\n        return <CheckCircle className=\"h-16 w-16 text-green-500\" />;\n      case 'error':\n        return <AlertCircle className=\"h-16 w-16 text-red-500\" />;\n      default:\n        return <Loader className=\"h-16 w-16 text-blue-500 animate-spin\" />;\n    }\n  };\n\n  const getStatusColor = () => {\n    switch (status) {\n      case 'success':\n        return 'text-green-600';\n      case 'error':\n        return 'text-red-600';\n      default:\n        return 'text-blue-600';\n    }\n  };\n\n  return (\n    <div className=\"flex items-center justify-center min-h-screen bg-gray-50\">\n      <motion.div \n        className=\"text-center p-8 bg-white rounded-lg shadow-lg max-w-md mx-4\"\n        initial={{ opacity: 0, scale: 0.9 }}\n        animate={{ opacity: 1, scale: 1 }}\n        transition={{ duration: 0.3 }}\n      >\n        <motion.div \n          className=\"mb-6\"\n          initial={{ scale: 0 }}\n          animate={{ scale: 1 }}\n          transition={{ delay: 0.2, type: \"spring\", stiffness: 200 }}\n        >\n          {getStatusIcon()}\n        </motion.div>\n        \n        <motion.h2 \n          className={`text-xl font-semibold mb-4 ${getStatusColor()}`}\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ delay: 0.3 }}\n        >\n          {status === 'processing' && 'Processing Authorization'}\n          {status === 'success' && 'Authorization Successful'}\n          {status === 'error' && 'Authorization Failed'}\n        </motion.h2>\n        \n        <motion.p \n          className=\"text-gray-600 leading-relaxed\"\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ delay: 0.4 }}\n        >\n          {message}\n        </motion.p>\n        \n        {status === 'success' && (\n          <motion.p \n            className=\"text-sm text-gray-500 mt-4\"\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            transition={{ delay: 0.6 }}\n          >\n            This window will close automatically...\n          </motion.p>\n        )}\n        \n        {status === 'error' && (\n          <motion.p \n            className=\"text-sm text-gray-500 mt-4\"\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            transition={{ delay: 0.6 }}\n          >\n            Redirecting back to the app...\n          </motion.p>\n        )}\n      </motion.div>\n    </div>\n  );\n};\n\nexport default GoogleCalendarCallback;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,OAASC,MAAM,KAAQ,eAAe,CACtC,OAASC,WAAW,CAAEC,WAAW,CAAEC,MAAM,KAAQ,cAAc,CAC/D,MAAO,CAAAC,KAAK,KAAM,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE1B,KAAM,CAAAC,sBAAsB,CAAGA,CAAA,GAAM,CACnC,KAAM,CAACC,MAAM,CAAEC,SAAS,CAAC,CAAGZ,QAAQ,CAAC,YAAY,CAAC,CAAE;AACpD,KAAM,CAACa,OAAO,CAAEC,UAAU,CAAC,CAAGd,QAAQ,CAAC,6CAA6C,CAAC,CAErFD,SAAS,CAAC,IAAM,CACd,KAAM,CAAAgB,cAAc,CAAG,KAAAA,CAAA,GAAY,CACjC,KAAM,CAAAC,SAAS,CAAG,GAAI,CAAAC,eAAe,CAACC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAC7D,KAAM,CAAAC,IAAI,CAAGL,SAAS,CAACM,GAAG,CAAC,MAAM,CAAC,CAClC,KAAM,CAAAC,KAAK,CAAGP,SAAS,CAACM,GAAG,CAAC,OAAO,CAAC,CACpC,KAAM,CAAAE,KAAK,CAAGR,SAAS,CAACM,GAAG,CAAC,OAAO,CAAC,CAEpC,GAAIE,KAAK,CAAE,CACTC,OAAO,CAACD,KAAK,CAAC,cAAc,CAAEA,KAAK,CAAC,CACpCZ,SAAS,CAAC,OAAO,CAAC,CAClBE,UAAU,CAAC,uDAAuD,CAAC,CAEnE;AACA,GAAII,MAAM,CAACQ,MAAM,CAAE,CACjBR,MAAM,CAACS,KAAK,CAAC,CAAC,CAChB,CAAC,IAAM,CACLC,UAAU,CAAC,IAAM,CACfV,MAAM,CAACC,QAAQ,CAACU,IAAI,CAAG,GAAG,CAC5B,CAAC,CAAE,IAAI,CAAC,CACV,CACA,OACF,CAEA,GAAIR,IAAI,CAAE,CACR,GAAI,CACF;AACA,KAAM,CAAAS,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,iCAAiC,CAAE,CAC9DC,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CAAC,CACDC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CACnBC,kBAAkB,CAAEhB,IAAI,CACxBE,KAAK,CAAEA,KACT,CAAC,CACH,CAAC,CAAC,CAEF,KAAM,CAAAe,IAAI,CAAG,KAAM,CAAAR,QAAQ,CAACS,IAAI,CAAC,CAAC,CAElC,GAAID,IAAI,CAACE,OAAO,CAAE,CAChB;AACAC,YAAY,CAACC,OAAO,CAAC,6BAA6B,CAAEP,IAAI,CAACC,SAAS,CAACE,IAAI,CAACK,WAAW,CAAC,CAAC,CAErF/B,SAAS,CAAC,SAAS,CAAC,CACpBE,UAAU,CAAC,2CAA2C,CAAC,CAEvD;AACA,GAAII,MAAM,CAACQ,MAAM,CAAE,CACjBR,MAAM,CAACS,KAAK,CAAC,CAAC,CAChB,CAAC,IAAM,CACL;AACAC,UAAU,CAAC,IAAM,CACfV,MAAM,CAACC,QAAQ,CAACU,IAAI,CAAG,GAAG,CAC5B,CAAC,CAAE,IAAI,CAAC,CACV,CACF,CAAC,IAAM,CACLJ,OAAO,CAACD,KAAK,CAAC,2BAA2B,CAAEc,IAAI,CAAC,CAChD1B,SAAS,CAAC,OAAO,CAAC,CAClBE,UAAU,CAAC,wDAAwD,CAAC,CACtE,CACF,CAAE,MAAO8B,GAAG,CAAE,CACZnB,OAAO,CAACD,KAAK,CAAC,yBAAyB,CAAEoB,GAAG,CAAC,CAC7ChC,SAAS,CAAC,OAAO,CAAC,CAClBE,UAAU,CAAC,2DAA2D,CAAC,CACzE,CACF,CACF,CAAC,CAEDC,cAAc,CAAC,CAAC,CAClB,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAA8B,aAAa,CAAGA,CAAA,GAAM,CAC1B,OAAQlC,MAAM,EACZ,IAAK,SAAS,CACZ,mBAAOJ,IAAA,CAACL,WAAW,EAAC4C,SAAS,CAAC,0BAA0B,CAAE,CAAC,CAC7D,IAAK,OAAO,CACV,mBAAOvC,IAAA,CAACJ,WAAW,EAAC2C,SAAS,CAAC,wBAAwB,CAAE,CAAC,CAC3D,QACE,mBAAOvC,IAAA,CAACH,MAAM,EAAC0C,SAAS,CAAC,sCAAsC,CAAE,CAAC,CACtE,CACF,CAAC,CAED,KAAM,CAAAC,cAAc,CAAGA,CAAA,GAAM,CAC3B,OAAQpC,MAAM,EACZ,IAAK,SAAS,CACZ,MAAO,gBAAgB,CACzB,IAAK,OAAO,CACV,MAAO,cAAc,CACvB,QACE,MAAO,eAAe,CAC1B,CACF,CAAC,CAED,mBACEJ,IAAA,QAAKuC,SAAS,CAAC,0DAA0D,CAAAE,QAAA,cACvEvC,KAAA,CAACR,MAAM,CAACgD,GAAG,EACTH,SAAS,CAAC,6DAA6D,CACvEI,OAAO,CAAE,CAAEC,OAAO,CAAE,CAAC,CAAEC,KAAK,CAAE,GAAI,CAAE,CACpCC,OAAO,CAAE,CAAEF,OAAO,CAAE,CAAC,CAAEC,KAAK,CAAE,CAAE,CAAE,CAClCE,UAAU,CAAE,CAAEC,QAAQ,CAAE,GAAI,CAAE,CAAAP,QAAA,eAE9BzC,IAAA,CAACN,MAAM,CAACgD,GAAG,EACTH,SAAS,CAAC,MAAM,CAChBI,OAAO,CAAE,CAAEE,KAAK,CAAE,CAAE,CAAE,CACtBC,OAAO,CAAE,CAAED,KAAK,CAAE,CAAE,CAAE,CACtBE,UAAU,CAAE,CAAEE,KAAK,CAAE,GAAG,CAAEC,IAAI,CAAE,QAAQ,CAAEC,SAAS,CAAE,GAAI,CAAE,CAAAV,QAAA,CAE1DH,aAAa,CAAC,CAAC,CACN,CAAC,cAEbpC,KAAA,CAACR,MAAM,CAAC0D,EAAE,EACRb,SAAS,CAAE,8BAA8BC,cAAc,CAAC,CAAC,EAAG,CAC5DG,OAAO,CAAE,CAAEC,OAAO,CAAE,CAAC,CAAES,CAAC,CAAE,EAAG,CAAE,CAC/BP,OAAO,CAAE,CAAEF,OAAO,CAAE,CAAC,CAAES,CAAC,CAAE,CAAE,CAAE,CAC9BN,UAAU,CAAE,CAAEE,KAAK,CAAE,GAAI,CAAE,CAAAR,QAAA,EAE1BrC,MAAM,GAAK,YAAY,EAAI,0BAA0B,CACrDA,MAAM,GAAK,SAAS,EAAI,0BAA0B,CAClDA,MAAM,GAAK,OAAO,EAAI,sBAAsB,EACpC,CAAC,cAEZJ,IAAA,CAACN,MAAM,CAAC4D,CAAC,EACPf,SAAS,CAAC,+BAA+B,CACzCI,OAAO,CAAE,CAAEC,OAAO,CAAE,CAAC,CAAES,CAAC,CAAE,EAAG,CAAE,CAC/BP,OAAO,CAAE,CAAEF,OAAO,CAAE,CAAC,CAAES,CAAC,CAAE,CAAE,CAAE,CAC9BN,UAAU,CAAE,CAAEE,KAAK,CAAE,GAAI,CAAE,CAAAR,QAAA,CAE1BnC,OAAO,CACA,CAAC,CAEVF,MAAM,GAAK,SAAS,eACnBJ,IAAA,CAACN,MAAM,CAAC4D,CAAC,EACPf,SAAS,CAAC,4BAA4B,CACtCI,OAAO,CAAE,CAAEC,OAAO,CAAE,CAAE,CAAE,CACxBE,OAAO,CAAE,CAAEF,OAAO,CAAE,CAAE,CAAE,CACxBG,UAAU,CAAE,CAAEE,KAAK,CAAE,GAAI,CAAE,CAAAR,QAAA,CAC5B,yCAED,CAAU,CACX,CAEArC,MAAM,GAAK,OAAO,eACjBJ,IAAA,CAACN,MAAM,CAAC4D,CAAC,EACPf,SAAS,CAAC,4BAA4B,CACtCI,OAAO,CAAE,CAAEC,OAAO,CAAE,CAAE,CAAE,CACxBE,OAAO,CAAE,CAAEF,OAAO,CAAE,CAAE,CAAE,CACxBG,UAAU,CAAE,CAAEE,KAAK,CAAE,GAAI,CAAE,CAAAR,QAAA,CAC5B,gCAED,CAAU,CACX,EACS,CAAC,CACV,CAAC,CAEV,CAAC,CAED,cAAe,CAAAtC,sBAAsB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}